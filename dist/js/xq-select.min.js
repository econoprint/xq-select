/*!
 * xqSelect v3.1 (https://github.com/exactquery/xq-select)
 * @author  Aaron M Jones [aaron@jonesiscoding.com]
 * @licence MIT (https://github.com/exactquery/xq-select/blob/master/LICENSE)
 */;(function($){$.xqselect=function(el,options){var defaults={cls:{wrapper:'xq-select-wrapper',dropdown:'dropdown-menu',toggle:'dropdown-toggle',option:'xq-select-item'},attr:{dropdown:{'role':'menu'},toggle:{'type':'button','data-toggle':'dropdown','aria-haspopup':'true','aria-expanded':'false'}},fauxOptionDefault:'--'};var plugin=this;plugin.settings={};plugin.sel={};var init=function(){plugin.settings=$.extend({},defaults,options);plugin.$el=$(el);$.each(plugin.settings.cls,function(key,val){plugin.sel[key]='.'+val;});var use=(plugin.$el.attr('data-native')!=='true')&&!(plugin.$el.prop('disabled')||plugin.$el.prop('readonly')&&!(isMobile()&&plugin.$el.attr('data-mobile')!=='true'));if(use){var $wrapper=createWrapper();$wrapper.append($('<button>&nbsp;</button>').attr($.extend({},plugin.settings.attr.toggle,{'tabindex':plugin.$el.attr('tabindex')||0})).addClass(plugin.settings.cls.toggle)).append(addOptions($('<ul></ul>').attr(plugin.settings.attr.dropdown).addClass(plugin.settings.cls.dropdown)));}};plugin.onClick=function(obj){var $obj=$(obj);var $target=$($obj.attr('data-target'));var $dropdown=$obj.parents(plugin.sel.dropdown);if(!$obj.hasClass('disabled')){$target.val($obj.attr('data-value'));$dropdown.children('li').removeClass('selected');$obj.addClass('selected');$target.trigger('change');}
$dropdown.prev(plugin.sel.toggle).focus();};plugin.onKeyDown=function(e,obj){if(e.which===13){e.preventDefault();$(obj).click();}};plugin.onOpen=function(e,obj){var $txqs=$(e.target);var $window=$(window);var $ul=$txqs.children(plugin.sel.dropdown);var $button=$txqs.children(plugin.sel.toggle);var ulOffset=$ul.offset()||0;var spaceUp=(ulOffset.top-$button.height()-$ul.height())-$window.scrollTop();var spaceDown=$window.scrollTop()+$window.height()-(ulOffset.top+$ul.height());if(spaceDown<0&&(spaceUp>=0||spaceUp>spaceDown)){$txqs.addClass('dropup');}
$(obj).find(plugin.sel.option+'.selected').focus();};plugin.closeDropDown=function(obj){$(obj).parent(plugin.sel.wrapper).removeClass('open');$(obj).prev(plugin.sel.toggle).attr('aria-expanded',false);};var addOptions=function($dropdown){var target='#'+getElId();plugin.$el.children().each(function(){var $opt=$(this);if($opt.prop('tagName')==='OPTION'){$dropdown.append(createOption($opt,target));}else if($opt.prop('tagName')==='OPTGROUP'){$dropdown.append(createOptGroup($opt));$opt.children().each(function(){$dropdown.append(createOption($(this),target));});}});$dropdown.find('a').eq(plugin.$el.prop('selectedIndex')).addClass('selected');return $dropdown;};var createOption=function($optObj,target){var index=$optObj.index(target+' option');var $ddLink=$('<a tabindex="'+index+'"></a>');var css=($optObj.attr('disabled'))?'xq-select-item disabled':'xq-select-item';$ddLink.html(getOptionText($optObj));$ddLink.attr('data-value',$optObj.val()).attr('data-target',target).attr('data-index',index).addClass(css);var subText=$optObj.attr('data-subtext')||null;if(subText){$ddLink.append($('<span></span>').text(subText));if($optObj.text().length<subText.length){$optObj.attr('data-original-text',$optObj.text());$optObj.append(' <span>('+subText+')</span>');}}
return $('<li></li>').append($ddLink);};var createOptGroup=function($grpObj){return $('<li></li>').addClass('optgroup').text($grpObj.attr('label')||plugin.settings.fauxOptionDefault);};var getElId=function(){var id=plugin.$el.prop('id')||null;if(!id){id='xqSelect_'+Math.random().toString(36).substr(2,9);plugin.$el.prop('id',id);}
return id;};var getOptionText=function($optObj){var ddText=$optObj.attr('data-original-text')||$optObj.text()||plugin.settings.fauxOptionDefault;if(ddText===plugin.settings.fauxOptionDefault){$optObj.html(ddText);}
return ddText;};var createWrapper=function(){var $wrapper=plugin.$el.parents(plugin.sel.wrapper);$wrapper.find(plugin.sel.dropdown).remove();$wrapper.find(plugin.sel.toggle).remove();return $wrapper.off().on('shown.bs.dropdown',function(e){plugin.onOpen(e,this);}).on('hidden.bs.dropdown',function(e){$(e.target).removeClass("dropup");}).on('keydown',plugin.sel.dropdown,function(e){if(e.which===9){plugin.closeDropDown(this);}}).on('keydown',plugin.sel.option,function(e){plugin.onKeyDown(e,this);}).on('click',plugin.sel.option,function(){plugin.onClick(this);});};var isMobile=function(){return true===(/(android|blackberry|bb10|mobile|iphone|ipad|ipod|opera mini|iemobile|windows phone)/i.test(navigator.userAgent));};init();};$.fn.xqselect=function(options){return this.each(function(){if(undefined===$(this).data('xqselect')){var plugin=new $.xqselect(this,options);$(this).data('xqselect',plugin);}});}})(jQuery);$(document).ready(function(){$('.xq-select').xqselect();});